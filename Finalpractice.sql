USE sakila;

/*1) Cree toda la data de las peliculas, inventarios y actores en un vista (view)
CREATE VIEW DATA_FIA AS(
SELECT inventory.store_id, inventory.inventory_id, film.title, film.description, film.release_year, film.language_id, film.original_language_id,
    film.rental_duration, film.rental_rate, film.length, film.replacement_cost, film.rating, film.special_features, 
     film.film_id, actor.actor_id, actor.first_name, actor.last_name
	from film_actor
	INNER JOIN film on film_actor.film_id = film.film_id
	INNER JOIN inventory on inventory.film_id = film.film_id
	INNER JOIN actor on actor.actor_id = film_actor.actor_id
    
    group by film.film_id,
    inventory.inventory_id, inventory.store_id, actor.actor_id
);

*/

/*2) Cree un procedure que actualice el promedio de renta (rental_rate) en la tabla film, basado 
en promedio de renta mensual de dicha pelicula. Recibe como parametro el filmid y un rango de fecha.

BEGIN
CREATE PROCEDURE `sp_Actualizar_rental` (in v_film_id smallint(5), in v_date date)

    UPDATE film
    SET film.rental_rate = 1.00
    where film.film_id = v_film_id and exists(
		select '1'
        FROM rental
		WHERE month(rental.rental_date) = month(v_date))
END    

PARA EJECUTAR
call sp_Actualizar_rental(1, '2005/06/30');

/* PARA CONSULTAR QUE TODO FUE BIEN
SELECT * 
from film;

SELECT *
FROM rental
INNER JOIN inventory on inventory.inventory_id = rental.inventory_id
where month(rental_date) = 6 and day(rental_date) = 30;
*/


/*3) Cree las ciudades de sus abuelos y familiares en el interior en city.
Cree 20 de su familiares en customer (incluye direccion).
 Cree 10 peliculas (inventario, store, actores), y creee unos 50 pagos y rentas de las mismas. 
 Ultice peliculas recientes y que le gusten a usted y su familia. 
 Muestre en un view toda la data insertada en el contexto de la renta.*/ 
 
 
Select * from staff;
Select * from store;
Select avg(amount) from payment;
Select * from payment where payment_id >  16049 ;
Select * from rental where rental_id > 16049;
select * from inventory;
 
 
 /*TOTAL DE DIRECCIONES INSERTADAS*/
 /*
INSERT INTO `sakila`.`address`
(`address_id`,
`address`,
`address2`,
`district`,
`city_id`,
`postal_code`,
`phone`,
`location`,
`last_update`)
VALUES
(606,
'Calle G',
null,
'Nacional',
603,
62558,
809-999-9999,
GeomFromText( ' POINT(18.517717 -69.876990) ' ),
'2020-10-04 15:15:15.59');



INSERT INTO address
VALUES
(607,'Calle F',null,'Nacional',
603,
62558,
809-111-9999,
GeomFromText( ' POINT(23.5 44.8) ' ),
'2020-10-04 15:15:15.59');


INSERT INTO address
VALUES
(608,
'Quisquella',
null,
'Valverde',
601,
62558,
809-111-9999,
GeomFromText( ' POINT(255 44.8) ' ),
'2020-10-04 15:15:15.59');


INSERT INTO address
VALUES
(609,
'Calle Musaenda',
null,
'San Felipe',
602,
62558,
809-111-9999,
GeomFromText( ' POINT(900 44.8) ' ),
'2020-10-04 15:15:15.59');


INSERT INTO address
VALUES
(610,
'Calle del Sol',
null,
'Caballeros',
460,
62558,
809-111-9999,
GeomFromText( ' POINT(540 55.8) ' ),
'2020-10-04 15:15:15.59');



select * from address;
*/

   /*TOTAL DE CIDUDADES INSERTADAS*/
   /*
	INSERT INTO city (city_id, city, country_id, last_update)
	values (601, 'Mao', 27,'2020-10-04 15:15:15.59');
 
	INSERT INTO city (city_id, city, country_id, last_update)
	values (602, 'Puerto Plata', 27,'2020-10-04 15:30:15.59');
 
	INSERT INTO city (city_id, city, country_id, last_update)
	values (603, 'Santo Domingo', 27,'2020-10-04 16:40:00.59');
    
  
  
  
  
  SELECT max(city_id) from city;
  
    SELECT * 
    from city
    where country_id = 27;
    
  SELECT * from country where country.country LIKE 'Do%';
  */


	/*TOTAL (20) CUSTOMERS*/
   /*
   INSERT INTO customer (customer_id, store_id, first_name, last_name, email, address_id, active, create_date, last_update)
values (600, 1, 'Edwin', 'Roman', 'Romanseberino@gmail.com', 606, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(601, 1, 'Alberto', 'Roman', 'Romans0001@gmail.com', 609, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(602, 1, 'Bryan', 'Valdez', 'Bryes@gmail.com', 606, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(603, 1, 'Nadia', 'Francisco', 'Nadi@gmail.com', 601, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(604, 1, 'Andrea', 'Seberino', 'Andra21@gmail.com', 601, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(605, 1, 'Jerli', 'Seberino', 'NGKJ21@gmail.com', 601, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(606, 1, 'Merlyn', 'Gonzalez', 'Merla@gmail.com', 601, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(607, 1, 'Joan', 'Roman', 'Joan36@gmail.com', 601, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(608, 1, 'Susan', 'Gill', 'Gill@gmail.com', 607, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(609, 1, 'Elena', 'Gonzalez', 'Elena@gmail.com', 609, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(610, 1, 'Adolfo', 'Roman', 'Adold@gmail.com', 609, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(611, 2, 'Yamis', 'Roman', 'Yamirus@gmail.com', 610, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(612, 2, 'Jose', 'Roman', 'Dolfito@gmail.com', 610, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(613, 2, 'Gabis', 'Santana', 'Gbi@gmail.com', 606, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(614, 2, 'Denias', 'Perez', 'Deania@gmail.com', 606, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(615, 2, 'Maria', 'Santana', 'Maraitiktok@gmail.com', 606, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(616, 2, 'Fleysi', 'Roa', 'Fly@gmail.com', 607, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(617, 2, 'Jonny', 'Roman', 'RomJon@gmail.com', 609, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(618, 2, 'Yetty', 'Pe√±a', 'Yww2@gmail.com', 609, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(619, 2, 'Dionisio', 'Castillo', 'CaDiony@gmail.com', 609, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59'),
(620, 2, 'Ramona', 'Del Orbe', 'Dorbe@gmail.com', 606, 1, '2020-10-04 15:15:15.59', '2020-10-05 00:00:00.59');


   
   */ 
 
 
/* TOTAL (50) Insertar rentas
INSERT INTO rental
(`rental_id`,`rental_date`,`inventory_id`,`customer_id`,`return_date`,`staff_id`,`last_update`)
VALUES
(16050,'2020-10-08 09:43:00',4582,600,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16051,'2020-10-08 09:43:00',4583,601,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16052,'2020-10-08 09:43:00',4584,602,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16053,'2020-10-08 09:43:00',4585,603,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16054,'2020-10-08 09:43:00',4586,604,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16055,'2020-10-08 09:43:00',4588,605,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16056,'2020-10-08 09:43:00',4587,606,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16057,'2020-10-08 09:43:00',4589,607,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16058,'2020-10-08 09:43:00',4590,608,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16059,'2020-10-08 09:43:00',4591,609,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),

(16060,'2020-10-08 09:43:00',4592,600,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16061,'2020-10-08 09:43:00',4593,601,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16062,'2020-10-08 09:43:00',4594,602,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16063,'2020-10-08 09:43:00',4595,603,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16064,'2020-10-08 09:43:00',4596,604,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16065,'2020-10-08 09:43:00',4597,605,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16066,'2020-10-08 09:43:00',4598,606,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16067,'2020-10-08 09:43:00',4599,607,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16068,'2020-10-08 09:43:00',4600,608,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16069,'2020-10-08 09:43:00',4601,609,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),

(16070,'2020-10-08 09:43:00',4602,600,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16071,'2020-10-08 09:43:00',4603,601,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16072,'2020-10-08 09:43:00',4604,602,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16073,'2020-10-08 09:43:00',4605,603,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16074,'2020-10-08 09:43:00',4606,604,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16075,'2020-10-08 09:43:00',4607,605,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16076,'2020-10-08 09:43:00',4608,606,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16077,'2020-10-08 09:43:00',4609,607,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16078,'2020-10-08 09:43:00',4610,608,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16079,'2020-10-08 09:43:00',4611,609,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),


(16080,'2020-10-08 09:43:00',4612,600,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16081,'2020-10-08 09:43:00',4613,601,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16082,'2020-10-08 09:43:00',4614,602,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16083,'2020-10-08 09:43:00',4615,603,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16084,'2020-10-08 09:43:00',4616,604,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16085,'2020-10-08 09:43:00',4617,605,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16086,'2020-10-08 09:43:00',4618,606,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16087,'2020-10-08 09:43:00',4619,607,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16088,'2020-10-08 09:43:00',4620,608,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16089,'2020-10-08 09:43:00',4621,609,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),


(16090,'2020-10-08 09:43:00',4622,600,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16091,'2020-10-08 09:43:00',4623,601,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16092,'2020-10-08 09:43:00',4624,602,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16093,'2020-10-08 09:43:00',4625,603,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16094,'2020-10-08 09:43:00',4626,604,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16095,'2020-10-08 09:43:00',4627,605,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16096,'2020-10-08 09:43:00',4628,606,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16097,'2020-10-08 09:43:00',4629,607,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30'),
(16098,'2020-10-08 09:43:00',4630,608,'2020-10-10 10:00:30',3,'2020-10-10 10:00:30'),
(16099,'2020-10-08 09:43:00',4631,609,'2020-10-10 10:00:30',4,'2020-10-10 10:00:30');

*/
 
 
/* TOTAL (50) Insertar pagos

INSERT INTO payment
(`payment_id`,`customer_id`,`staff_id`,`rental_id`,`amount`,`payment_date`,`last_update`)
VALUES
(16050, 600,3,16050,9.00,'2020-10-08 09:43:00','2020-10-10 10:00:30'),
(16051,601,3,16052,9.00,'2020-10-08 09:43:00','2020-10-10 10:00:30'),
(16052,602,4,16053,9.00,'2020-10-08 09:43:00','2020-10-10 10:00:30'),
(16053,603,3,16053,9.00,'2020-10-08 09:43:00','2020-10-10 10:00:30'),
(16054,604,4,16054,4.77,'2020-10-08 09:43:00','2020-10-10 10:00:30'),
(16055,605,3,16055,4.77,'2020-10-08 09:43:00','2020-10-10 10:00:30'),
(16056,606,4,16056,9.00,'2020-10-08 09:43:00','2020-10-10 10:00:30'),
(16057,607,3,16057,4.77,'2020-10-08 09:43:00','2020-10-10 10:00:30'),
(16058,608,4,16058,4.77,'2020-10-08 09:43:00','2020-10-10 10:00:30'),
(16059,609,4,16059,9.00,'2020-10-08 09:43:00','2020-10-10 10:00:30'),

(16060,600,4,16060,4.22,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16061,601,4,16061,19.22,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16062,602,3,16062,7.32,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16063,603,4,16063,7.32,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16064,604,3,16064,19.22,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16065,605,4,16065,7.32,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16066,606,3,16066,7.32,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16067,607,4,16067,19.22,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16068,608,3,16068,19.22,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16069,609,3,16069,19.22,'2020-10-10 10:00:30','2020-10-10 10:00:30'),

(16070,600,4,16070,6.46,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16071,601,4,16071,6.46,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16072,602,3,16072,6.46,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16073,603,4,16073,4.46,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16074,604,3,16074,6.46,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16075,605,4,16075,2.46,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16076,606,3,16076,9.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16077,607,4,16077,4.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16078,608,3,16078,5.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16079,609,3,16079,8.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),


(16080,600,4,16080,3.99,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16081,601,4,16081,9.99,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16082,602,3,16082,3.99,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16083,603,4,16083,3.99,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16084,604,3,16084,4.99,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16085,605,4,16085,9.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16086,606,3,16086,4.99,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16087,607,4,16087,9.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16088,608,3,16088,4.99,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16089,609,3,16089,9.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),


(16090,600,3,16090,5.84,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16091,601,3,16091,9.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16092,602,3,16092,5.84,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16093,603,3,16093,9.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16094,604,4,16094,5.84,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16095,605,4,16095,7.59,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16096,606,4,16096,9.66,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16097,607,4,16097,7.59,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16098,608,3,16098,3.99,'2020-10-10 10:00:30','2020-10-10 10:00:30'),
(16099,609,4,16099,7.59,'2020-10-10 10:00:30','2020-10-10 10:00:30');

*/

/*ULTIMA VISTA	*/
CREATE VIEW All_last_data
AS (
	SELECT *,'All last data inserted' as 'Message'
    FROM rental 
    where rental_id > 16049
);